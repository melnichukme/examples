Наверное лишнее, но все же есть пример миграции, пытаюсь делать полную оптимизацию производительности с учетом требований. 
Так же пару примеров извращенных запросов) лучше не спрашивайте что они делают))